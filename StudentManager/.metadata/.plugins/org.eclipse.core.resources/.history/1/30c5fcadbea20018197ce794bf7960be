<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
"-//Hibernate/Hibernate Mapping DTD//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="com.runsystem.datnt.entities">
	
	<class name="Student" table="STUDENT">
		
		<id name="studentId" type="int" column="student_id">
			<generator class="native" />
		</id>
		
		<property name="studentCode" type="string" column="student_code" />
		<property name="studentName" type="string" column="student_name" />
		<property name="startYear"   type="string"   column="student_startyear" />
		
		<many-to-one name="school" column="school_id" class="School" not-null="true" />
		
		<one-to-one  name="record" class="Records" cascade="all" />
		
		<one-to-one  name="user"   class="User" cascade="all" />
		
	</class>
	
	<sql-query name="getLastStudentCode">
		<![CDATA[
			SELECT MAX(student_code) FROM STUDENT 
		]]>
	</sql-query>
	
	<sql-query name="selectStudentByCode">
		<return alias="student" class="Student" />
		<![CDATA[
			SELECT * FROM STUDENT WHERE student_code = :studentcode
		]]>
	</sql-query>
	
	<sql-query name="searchStudent">
		<return alias="student" class="Student" />
		<![CDATA[
			SELECT st.* 
			FROM STUDENT as st AND RECORDS as r 
			WHERE st.student_code = :code 
				  and st.student_name like :name
		]]>
	</sql-query>

</hibernate-mapping>