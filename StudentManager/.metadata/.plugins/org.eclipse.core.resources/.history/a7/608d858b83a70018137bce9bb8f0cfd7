package com.runsystem.datnt.aops;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import org.aspectj.lang.ProceedingJoinPoint;

import com.runsystem.datnt.daos.interfaces.TokenDao;

public class CheckTokenAOP {
	
	private TokenDao tokenDao;
	
	public void onCheck(ProceedingJoinPoint joinPoint) {
		Object[] agrs = joinPoint.getArgs();
		HttpServletRequest req = null;
		HttpSession session = null;
		
		for (Object obj : agrs) {
			if (obj instanceof HttpServletRequest) {
				req = (HttpServletRequest) obj;
			}
		}
		
		session = req.getSession();
		String userToken = (String) session.getAttribute("userToken");
		if (userToken != null && !userToken.isEmpty()) {
			Token token = tokenDao.selectByUserSeries(username, userToken);
		}
		
	}

	public TokenDao getTokenDao() {
		return tokenDao;
	}

	public void setTokenDao(TokenDao tokenDao) {
		this.tokenDao = tokenDao;
	}
}
