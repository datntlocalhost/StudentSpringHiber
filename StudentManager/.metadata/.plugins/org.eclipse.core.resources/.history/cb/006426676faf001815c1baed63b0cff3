package com.runsystem.datnt.utils;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;

public class SqlUtils {
	
	public static final String SCHOOL_LIST              = "sql/school_list.sql";
	public static final String SCHOOL_ID_BY_CODE        = "sql/select_school_id_by_code.sql";
	
	public static final String STUDENT_LIST			    = "sql/student_list.sql";
	public static final String SEARCH_STUDENT           = "sql/search_student.sql";
	public static final String SEARCH_STUDENT_WITH_DATE = "sql/search_student_with_date.sql";
    public static final String UPDATE_STUDENT			= "sql/update_student.sql";
	public static final String SELECT_STUDENT_BY_CODE   = "sql/select_student_by_code.sql";
	
	public static final String INSERT_RECORDS           = "sql/insert_records.sql";
	public static final String DELETE_RECORDS		    = "sql/delete_records.sql";
	
	
	/*
	 * Read query string from the file .sql and return a query string.
	 * 
	 * @param path
	 * 		  path of the .sql file
	 * 
	 * @return string
	 * 
	 * @throws IOException
	 */
	public static String getSQL(String path) throws IOException {
		
		ClassLoader classLoader = SqlUtils.class.getClassLoader();
		
		BufferedReader bufferedReader = new BufferedReader(new FileReader(classLoader.getResource(path).getFile()));
		
		StringBuilder stringBuilder = new StringBuilder();
		
		String string;
		
		while ( (string = bufferedReader.readLine()) != null ) {
			stringBuilder.append(string);
		}
		
		bufferedReader.close();
		return stringBuilder.toString();
	}
}
